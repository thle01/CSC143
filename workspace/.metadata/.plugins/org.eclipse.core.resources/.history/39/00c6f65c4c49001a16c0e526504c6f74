package queens;

import java.awt.Graphics;
import java.awt.Image;
import java.io.File;
import javax.swing.ImageIcon;
import javax.swing.JPanel;

import com.sun.org.apache.bcel.internal.generic.RETURN;

public class ControlPanel extends JPanel {
	private static final long serialVersionUID = 5L;
	private static final int SIZE = 3;
	private String imageLocation;
	private ImageIcon queenIcon;
	private Image queenImage;
	private int[] rowPositions;
	private int startingColumn;

	public ControlPanel() {
		this(0);
	}

	public ControlPanel(int start) {
		startingColumn = start;
		imageLocation = "images" + File.separator + "queen.jpg";
		queenIcon = new ImageIcon(imageLocation);
		queenImage = queenIcon.getImage();
		rowPositions  	= new int[SIZE];
		

	}

	public void draw(Graphics _graphics) {
		if (search(0, startingColumn)) {
			drawQueens(_graphics);
			drawChessBoard(_graphics);
		}
	}

	public void drawChessBoard(Graphics _graphics) {
		for (int i = 0; i < SIZE; i++) {
			_graphics.drawLine(0, i * getHeight() / SIZE, getWidth(), i * getHeight() / SIZE);
			_graphics.drawLine(i * getWidth() / SIZE, 0, i * getWidth() / SIZE, getHeight());
		}
	}

	public void drawQueens(Graphics _graphics) {
		int j; // position of queen in row i
		int imageX = 0;
		int imageY = 0;
		int imageWidth = 0;
		int imageHeight = 0;

		if (queenImage != null) {
			for (int i = 0; i < SIZE; i++) {
				j = rowPositions[i];
				imageX = j * getWidth() / SIZE;
				imageY = i * getHeight() / SIZE;
				imageWidth = getWidth() / SIZE;
				imageHeight = getHeight() / SIZE;
				_graphics.drawImage(queenImage, imageX, imageY, imageWidth, imageHeight, this);
			}
		}
	}

	

	public boolean isSafe(int row, int col) {
		for (int i = 0; i < SIZE; i++) {
			if (rowPositions[i]== col)
				return false;
		}
		for (int i = 0; i < row; i++) {
			if (Math.abs(i-row) == Math.abs(rowPositions[i]-col))
				return false;
		}
		return true;
	}

	public void paintComponent(Graphics _graphics) {
		super.paintComponent(_graphics);
		draw(_graphics);
	}

	
	public boolean search(int row, int start) {
		if (start > SIZE)	
			return true;
		else {
//looping through the col. go from 0 to SIZE (8)
// i {0,1,2,3,4,5,6,7,8} --columns loop			
			for (int i = 0; i < SIZE; i++) {
				if(isSafe(row, i)) {
//If the location is safe then put the queen in
					rowPositions[row] = i;
//move on to the next row					
					if (search(row+1, i+1)) {
						return true;
					}
//why do we have to un-choose/remove					
					rowPositions[row] = -1;
				}
			}
		}
				
		return false;
	}
	
	
}
